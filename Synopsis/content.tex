%% authorvak
\nocite{Sinuk2020}%
\nocite{Karatach2021}%
\nocite{Karatach2023}%
\nocite{vakbib4}%
\nocite{vakbib5}%
\nocite{vakbib6}%
\nocite{vakbib7}%
\nocite{vakbib8}%
\nocite{vakbib9}%
\nocite{vakbib10}%
\nocite{vakbib11}%
\nocite{vakbib12}%
%
%% authorwos
\nocite{Sinuk2023}%
\nocite{Karatach2024}%
\nocite{wosbib1}%
%
%% authorscopus
\nocite{Karatach2023b}%
%
%% authorpatent
\nocite{patbib1}%
%
%% authorconf
\nocite{Karatach2020}%
\nocite{Karatach2021parallel}%
\nocite{Sinuk2022}%
\nocite{Karatach2022}%
\nocite{Sinuk2023kii}%
%
%% authorother
\nocite{bib1}%
\nocite{bib2}%
%
%% authorprogram
\nocite{Rospatent1}%
\nocite{Rospatent2}%

\pdfbookmark{Общая характеристика работы}{characteristic}             % Закладка pdf
\section*{Общая характеристика работы}

\newcommand{\actuality}{\pdfbookmark[1]{Актуальность}{actuality}\underline{\textbf{\actualityTXT}}}
\newcommand{\progress}{\pdfbookmark[1]{Разработанность темы}{progress}\underline{\textbf{\progressTXT}}}
\newcommand{\aim}{\pdfbookmark[1]{Цели}{aim}\underline{{\textbf\aimTXT}}}
\newcommand{\tasks}{\pdfbookmark[1]{Задачи}{tasks}\underline{\textbf{\tasksTXT}}}
\newcommand{\aimtasks}{\pdfbookmark[1]{Цели и задачи}{aimtasks}\aimtasksTXT}
\newcommand{\researchObject}{\pdfbookmark[1]{Объект исследования}{researchObject}\underline{\textbf{\researchObjectTXT}}}
\newcommand{\researchSubject}{\pdfbookmark[1]{Предмет исследования}{researchSubject}\underline{\textbf{\researchSubjectTXT}}}
\newcommand{\novelty}{\pdfbookmark[1]{Научной новизной}{novelty}\underline{\textbf{\noveltyTXT}}}
\newcommand{\theoreticalValue}{\pdfbookmark[1]{Теоретическая значимость}{theoreticalValue}\underline{\textbf{\theoreticalValueTXT}}}
\newcommand{\practicalValue}{\pdfbookmark[1]{Практическая значимость}{practicalValue}\underline{\textbf{\practicalValueTXT}}}
\newcommand{\influence}{\pdfbookmark[1]{Практическая значимость}{influence}\underline{\textbf{\influenceTXT}}}
\newcommand{\methods}{\pdfbookmark[1]{Методология и методы исследования}{methods}\underline{\textbf{\methodsTXT}}}
\newcommand{\defpositions}{\pdfbookmark[1]{Положения, выносимые на защиту}{defpositions}\underline{\textbf{\defpositionsTXT}}}
\newcommand{\specialityRelation}{\pdfbookmark[1]{Область исследования}{specialityRelation}\underline{\textbf{\specialityRelationTXT}}}
\newcommand{\reliability}{\pdfbookmark[1]{Достоверность}{reliability}\underline{\textbf{\reliabilityTXT}}}
\newcommand{\probation}{\pdfbookmark[1]{Апробация}{probation}\underline{\textbf{\probationTXT}}}
\newcommand{\contribution}{\pdfbookmark[1]{Личный вклад автора.}{contribution}\underline{\textbf{\contributionTXT}}}
\newcommand{\publications}{\pdfbookmark[1]{Публикации}{publications}\underline{\textbf{\publicationsTXT}}}

\input{common/characteristic} % Характеристика работы по структуре во введении и в автореферате не отличается (ГОСТ Р 7.0.11, пункты 5.3.1 и 9.2.1), потому её загружаем из одного и того же внешнего файла, предварительно задав форму выделения некоторым параметрам

%Диссертационная работа была выполнена при поддержке грантов \dots

%\underline{\textbf{Объем и структура работы.}} Диссертация состоит из~введения,
%четырех глав, заключения и~приложения. Полный объем диссертации
%\textbf{ХХХ}~страниц текста с~\textbf{ХХ}~рисунками и~5~таблицами. Список
%литературы содержит \textbf{ХХX}~наименование.

\pdfbookmark{Содержание работы}{description}                          % Закладка pdf
\section*{Содержание работы}

\textbf{Во введении} описана актуальность работы, сформулированы цель и задачи исследования, изложены основные результаты, их теоретическая и практическая значимость, приведена новизна исследования и защищаемые положения. 

%обосновывает актуальность анализа зашумленных и неопределённых данных за счет использования несинглтонной фаззификации в нечетких системах, сообщает о достигнутом прогрессе в использовании нечетких систем типа Мамдани для использования несинглтонной фаззификации. Указывается, что эти наработки имеют упрощенный за счет принятых допущений автора, а сам нечеткий вывод типа Мамдани отличается от классического нечеткого вывода Заде, неиспользуемого из-за сложности эффективной реализации.

\textbf{Глава 1. <<Анализ методов прогнозирования временных рядов в задачах управления с позиции адекватности учета уникальности свойств генерирующих их объектов>>}

% Проанализировал адекватность. Особое внимание обратил на распространенные модели. Показано, что они не учитывают тото-тото Что значит они не адекватны. На основе этого сформулированы задачи работы... Важный результат не точность прогнозирования а адекватность учета свойств.

В главе рассматривается роль информационной технологии прогнозирования в процессе управления. При этом внимание сосредоточено на применении информационной технологии прогнозирования, когда временные данные получены для уникального объекта или процесса. Схема такой системы изображена на рисунке \cref{fig:information-technology-diagram}. Под \textit{уникальным} понимается такой объект или процесс, для которого отсутствует или практически недостижима репрезентативная статистическая выборка аналогов, и который изучается исключительно на основе своей собственной динамики и свойств.

\begin{figure}[tbh!]
	\centering
	\includegraphics[width=\linewidth]{information-technology-diagram}
	\caption{Схема системы управления на основе информационной технологии прогнозирования.}
	\label{fig:information-technology-diagram}
\end{figure}

Для проработки методологии прогнозирования показателей таких уникальных объектов или процессов, проведен анализ адекватности учета оценок различного характера неопределенности во временных рядах моделями их прогнозирования, то есть степени соответствия способа отражения характеристик неопределенности в модели возможностям математического аппарата, на котором эти модели построены. Особое внимание уделено распространенным моделям прогнозирования, таким как, линейный предсказатель и модель Бокса-Дженкинса. В результате их анализа показано, что эти модели предполагают стационарность временного ряда, а статистические характеристики оцениваются для ансамбля объектов. Это делает применение данных моделей неадекватным в случае описания временным рядов некоторого уникального объекта или нестационарности самого временного ряда.

%, используемыми в задаче управления. \todo{}
%
%В главе описана роль прогнозирования временных рядов в задаче управления.
%
%Для оценки распространенных типов источников неопределенности, таких как измерительные ошибки, случайная (стохастическая) изменчивость процесса, структурный сдвиги, распространенные подходы моделирования временных рядов используют статистические способы оценки дисперсии шума, оценку автокорреляционной функции, статистические тесты на стационарность.
%
%Последний метод прогнозирования временных рядов предполагает, что ряд является стационарным, то есть обладает постоянством статистических характеристик. Другим часто используемым свойством временных рядов является свойство \textit{эргодичности}, когда среднее значение по ряду эквивалентно среднему значению, рассчитанным по всем набору реализаций этого ряда в некоторый момент времени.
%
%В некоторых случаях, например, при прогнозировании объема воды для некоторой ГЭС с уникальным географическим положением или при оценке воздействия лекарства на некоторый показатель организма человека с уникальными физиологическими свойствами, оценка статистических характеристик по ансамблю объектов невозможна или некорректна. Если при этом временной ряд по своей природе не обладает свойством эргодичности, то классические методы его моделирования оказываются неприменимы.
%
%Основанные на статистических характеристиках методы прогнозирования оперируют распределением вероятности, которое моделирует стохастическую неопределенность, возникающую из-за случайности событий. Нечеткая теория описывает распределение возможности посредством нечетких множеств, которое моделирует эпистемическую неопределенность, возникающую из-за неполноты или неточности собранной информации. Тогда для измеренных значений нечеткие множества могут быть построены по единичной реализации ряда, например, с использованием экспертной оценки или другого способа оценки их нечеткости. Тогда при использовании этих нечетких множеств в системе нечеткого вывода будет оцениваться степень их соответствия имеющимся в системе знаниям.


%В отличии от распределения вероятности, которое выражает степень соответствия какому-то конкретному закону распределения, распределение возможности выражает насколько значение $\mathbf{x}$ совместимо с имеющейся в нечеткой системе информацией\todo{, которая в системе на основе правил при логическом выводе является наиболее логичной аппроксимацией}. Это позволяет, помимо случайности ошибки измеренных значений, оценивать неопределенность, возникающую из-за неполноты знаний, меняющегося характера или постоянно нестабильного процесса.

На основе проведенного анализа сформулированы задачи исследования, решение которых направлено на достижение цели диссертационной работы.

\textbf{Глава 2. <<Разработка метода прогнозирования временных рядов с использованием нечетких систем на основе правил>>}

Глава посвящена разработке метода прогнозирования временных рядов на основе нечетких систем, адекватно учитывающей нечеткость временных рядов, а также решению проблемы экспоненциальной вычислительной сложности нечеткого логического вывода.

\ul{2.1. Задача нечеткого логического вывода}

Нечеткая система представляет собой базу правил вида:
\begin{equation}
	\label{eqn:fuz-problem-1}
	R_k:\ \text{Если}\ x_1\ \text{есть}\ A_{k1}\ \text{и}\ x_2\ \text{есть}\ A_{k2}\ \text{и} \dots \text{и}\ x_n\ \text{есть}\ A_{kn}, \text{то}\ y\ \text{есть}\ B_k,
\end{equation}
где $N$ "--- количество нечетких правил, $A_{ki} \subseteq X_i, i=\overline{1,n}, B_k \subseteq Y$"--- нечеткие множества, которые характеризуются функциями принадлежности $\mu_{A_{ki}}(x_i)$ и $\mu_{B_k}(y)$ соответственно; $x_1, x_2,…,x_n$"--- входные переменные, причем
\[
[x_1, x_2, ..., x_n]^T = \mathbf{x} \in X_1 \times X_2 \times \dots \times X_n.
\]

Символами  $X_i, i=\overline{1,n}$ и $Y$ обозначаются соответственно пространства входных и выходной переменных. Если ввести обозначения $\mathbf{X}=X_1 \times X_2 \times \dots \times X_n$ и $\mathbf{A_k}=A_{k1}\times A_{k2} \times \dots \times A_{kn}$ , причем
\[
\mu_\mathbf{A_k}(\mathbf{x}) = \underset{i=\overline{1,n}}{T_1} \mu_{A_{ki}}(x_i),
\]
где $T_1$ - произвольная $t$-норма, то правило \ref{eqn:fuz-problem-1} представляется в виде нечеткой импликации
\begin{equation}
	\label{eqn:fuz-problem-2}
	R_k: \mathbf{A_k} \to B_k, k=\overline{1,N}.
\end{equation}

Правило $R_k$ можно формализовать как нечеткое отношение, определенное на множестве  $\mathbf{X}\times Y$, т.е. $R_k \subseteq \mathbf{X} \times Y$ - нечеткое множество с функцией принадлежности
\[
\mu_{R_k}(\mathbf{x}, y) = \mu_{\mathbf{A_k} \to B_k} (\mathbf{x}, y).
\]

Модель логического типа определяет задание функции $\mu_{\mathbf{A_k} \to B_k} (\mathbf{x}, y)$ на основе известных функций принадлежности $\mu_{\mathbf{A_k}}(\mathbf{x})$ и $\mu_{B_k}(y)$ с помощью одной из функций нечеткой импликации:
\[
\mu_{\mathbf{A_k} \to B_k} (\mathbf{x}, y) = I(\mu_{\mathbf{A_k}}(\mathbf{x}), \mu_{B_k}(y)),
\]
где $I$"--- некоторая импликация.

Ставится задача определить нечеткий вывод $B'_k \subseteq Y$ для системы, представленной в виде (\ref{eqn:fuz-problem-1}), если на входах - нечеткие множества.
$\mathbf{A'}=A'_1 \times A'_2 \times \dots \times A'_n \subseteq \mathbf{X}$ или $x_1\ \text{есть}\ A'_1\ \text{и}\ x_2\ \text{есть}\ A'_2\ \text{и} \dots \text{и}\ x_n\ \text{есть}\ A'_n$  с соответствующей функцией принадлежности $\mu_{\mathbf{A'}}(\mathbf{x})$, которая определяется как
\begin{equation}
	\label{eqn:fuz-problem-3}
	\mu_{\mathbf{A'}}(\mathbf{x}) = \underset{i=\overline{1,n}}{T_3} \mu_{A'_i}(x_i).
\end{equation}

Несинглтонный фаззификатор отображает измеренное $x_i=x'_i, i=\overline{1,n}$ в нечеткое число, для которого $\mu_{A'_i}(x'_i) = 1$ и $\mu_{A'_i}(x_i)$ уменьшается от единицы по мере удаления от  $x'_i$.
В соответствии с обобщенным нечетким правилом modus ponens, нечеткое множество $B'_k$ определяется композицией нечеткого множества $\mathbf{A'}$ и отношения $\mathbf{R_k}$, т.е.
\[
B'_k = \mathbf{A'} \circ (\mathbf{A_k} \to B_k),
\]
или, на уровне функций принадлежности
\begin{equation}
	\label{eqn:fuz-problem-4}
	\mu_{B'_k}(y|\mathbf{x'}) = \sup_{\mathbf{x}\in \mathbf{X}}\left\{\mu_{\mathbf{A'}}(\mathbf{x'})\overset{T_2}{\star} I(\mu_{\mathbf{A_k}}(\mathbf{x}), \mu_{B_k}(y))\right\}.
\end{equation}

В (\ref{eqn:fuz-problem-4}) применена условная нотация, так как ввод в нечеткую систему происходит при определенном значении $\mathbf{x}$, а именно $\mathbf{x'}$. Обозначение $\mu_{B'_k}(y | \mathbf{x'})$ показывает, что $\mu_{B'_k}$ изменяется с каждым значением $\mathbf{x'}$.

\ul{2.2. Применение предложенного метода вывода в нечеткой модели для задачи прогнозирования временных рядов}

Пусть задан временной ряд $\left\{y_t\right\}_{t=1}^T = \left\{y_1, \dots, y_T\right\}$, где $y_t \in \mathbb{R}$ --- измеренное значение наблюдаемой переменной в момент времени $t$, а $T$ --- длина доступной выборки. При моделировании временных последовательностей с использованием нейро-нечетких систем каждое значение $y_t\in \mathbb{Y}\subseteq \mathbb{R}$ фаззифицируется в нечеткое множество $A'_t$. Тогда для прогнозирования значения $\hat{y}_{t+h}$ с горизонтом $h$ на основании среза наблюдений $y_{t-p+1}, \dots, y_t$ можно использовать нечеткую систему с базой из $N$ правил вида:
\begin{align*}
	R_k: \text{Если } \bigwedge_{i=1}^p \left(y_{t-i+1}\text{ есть }A_{ki}\right)\text{, то }y_{t+1}\textrm{ есть }A_{k\,p+1}, k=\overline{1,N},
\end{align*}
где $p$ --- размер окна запаздывания (порядок модели, количество входов нечеткой системы).

\ul{Процедура фаззификации.} Если значения входных нечетких множеств нечеткой системы задаются с использованием синглтонного типа фаззификации теряется информация о неопределенности измеренных значений $x'$ и они рассматриваются как достоверные. Поэтому в работе используется \textit{несинглтонный способ фаззификации}.

Для фаззификации с учетом нечеткости входных значений временного ряда в работе описана процедура адаптивной несинглтонной фаззификации временной последовательности, приведенная на рисунке \cref{fig:ns-procedure}, где получаемая в результате фаззификации функция принадлежности меняет форму на участках с низкой и высокой нестабильностью временных значений, как показано на рисунке \cref{fig:ns-demo-low-and-high-noise}.

\begin{figure}[ht]
	\begin{minipage}[c]{0.49\textwidth}
		\centering
		\includegraphics[width=\textwidth]{ns-procedure}
		\caption{Схема обобщенной процедуры адаптивной несинглтонной фаззификации временной последовательности.}
		\label{fig:ns-procedure}
	\end{minipage}
	\hfill
	\begin{minipage}[c]{0.49\textwidth}
		\centering
		%		\includegraphics[width=\textwidth]{ns-demo-low-noise}
		%		\includegraphics[width=\textwidth]{ns-demo-large-noise}
		\includegraphics[width=\textwidth]{ns-demo-low-and-high-noise}
		\caption{Иллюстрация процедуры несинглтонной фаззификации временного ряда с низким (вверху) и высоким (внизу) уровнем шума.}
		\label{fig:ns-demo-low-and-high-noise}
	\end{minipage}
\end{figure}

\ul{Выбор схемы дефаззификации.}
В задаче регрессии дискретная формула дефаззификации по центру тяжести или другие более простые схемы не показывают достаточной точности, а непрерывная формулировка первой имеет большую вычислительную сложность. Поэтому в работе для регрессии используется дефаззификация по среднему максимуму.

%Сетевая структура нечеткой системы для данного способа дефаззификации изображена на рис. \cref{fig:nfs-defuz-meom-with-defuz-demo}.
%
%\begin{figure}[tbh!]
%\centering
%\includegraphics[width=\linewidth]{nfs-defuz-meom-with-defuz-demo}
%\caption{Нейросетевая структура нечеткой модели с несинглтонной фаззификацией и дефаззификацией по среднему максимуму.}
%\label{fig:nfs-defuz-meom-with-defuz-demo}
%\end{figure}

\ul{2.3. Альтернативный метод нечеткого вывода с полиномиальной вычислительной сложностью}

\textbf{Вычислительная сложность выражения композиционного правила (\ref{eqn:fuz-problem-4}) для вывода логического типа при использовании несинглтонной фаззификации составляет ${O(|X_1|\cdot |X_2|\cdot \dots \cdot |X_n|\cdot |Y|)}$ т.е. экспоненциальная.} Это является актуальным препятствием использования нечеткого вывода логического типа совместно с несинглтонной фаззификацией.

Нечеткое значение истинности нечеткого множества $A$ относительно н. м. $A'$ представляет собой нечеткое множество с функцией принадлежности совместимости $CP(A, A')$ $A$ по отношению к $A'$, причем $A'$ рассматривается как достоверное:
\begin{equation}
	\label{eqn:ftv-compute-12}
	\tau_{A_k|A'}(v) = \mu_{CP(A_k, A')}(v) = \sup_{\substack{\mu_{A_k}(x) = v \\ x \in X}} \left\{ \mu_{A'}(x)\right\}.
\end{equation}

%На рисунке \cref{fig:ftv-all-cases} изображены функции принадлежности нечетких значений термов лингвистической переменной <<истинность>>.

Для нечеткой системы с одним входом истинностное преобразование позволяет выполнить переход к новому виду формулы композиционного правила вывода:
\begin{equation}
	\label{eqn:ftv-compute-5}
	\mu_{B'_k}(y|\mathbf{x'}) = \sup_{v \in [0,1]}\left\{\tau_{A_k|A'}(v) \overset{T_2}{\star} I(v, \mu_{B_k}(y))\right\}.
\end{equation}

Это соответствует новой структуре правил в базе правил:
\begin{equation}
	\text{Если } \textit{нзи} \text{ есть } \text{ИСТИННО}, \text{ то }\ y\ \text{есть}\ B'_k
	\label{eqn:ftv-compute-13}
\end{equation}

Для нечеткой системы с несколькими входами НЗИ вычисляются по каждому входу отдельно, а затем производится их свертка по расширенной по принципу обобщения $\tilde{T}$-норме.
\begin{align}
	\tau_{\mathbf{A_k}|\mathbf{A'}}(v) = \underset{i=\overline{1,n}}{\mathrm{\tilde{T}}} \tau_{A_{ki}|A'_i} &= \sup_{\substack{\underset{i=\overline{1,n}}{\mathrm{T_1}}v_i = v \\ (v_1, \dots, v_n) \in [0, 1]^n}} \left\{\underset{i=\overline{1,n}}{\mathrm{T_3}}\tau_{A_{ki}|A'_i}(v_i)\right\} \label{eqn:ftv-compute-8} \\ &= \sup_{\substack{\underset{i=\overline{1,n}}{\mathrm{T_1}}\mu_{A_{ki}}(x_i)=v \\ (x_1, \dots, x_n) \in \mathbf{x}}} \left\{ \underset{i=\overline{1,n}}{\mathrm{T_3}} \mu_{A'_i}(x_i) \right\}, v \in [0, 1]
	\label{eqn:ftv-compute-9},
\end{align}

Рекурсивная схема вычисления свертки НЗИ по формуле (\ref{eqn:ftv-compute-8}) иллюстрируется выражением:
\begin{align}
	\label{eqn:ftv-compute-10}
	\tau_{\mathbf{A_k}|\mathbf{A'}}(v) & = \underset{i=\overline{1,n}}{\mathrm{\tilde{T}_1}}\tau_{A_{ki}|A'_i}(v_i) \\
	& = \left(\dots\left(\left(\mu_{CP(A_{k1}, A'_1)}(v_1)\ \mathrm{\tilde{T}_1}\ \mu_{CP(A_{k2}, A'_2)}(v_2)\right)\ \mathrm{\tilde{T}_1}\ \dots \right) \mathrm{\tilde{T}_1}\ \mu_{CP(A_{kn}, A'_n)}\right).
\end{align}

Тогда для системы с $n$ входами выражения нечеткого вывода на основе НЗИ (\ref{eqn:ftv-compute-5}) примет вид:
\begin{equation}
	\label{eqn:ftv-compute-11}
	\mu_{B'_k}(y|\mathbf{x'}) = \sup_{v \in [0, 1]} \left\{\tau_{\mathbf{A_k}|\mathbf{A'}}(v) \overset{\mathrm{T_2}}{\star} I(v, \mu_{B_k}(y))\right\}
\end{equation}

\begin{figure}[tbh!]
	\centering
	\includegraphics[scale=0.45]{ftv-schema-comparizon}
	\caption{Сравнение классической схемы нечеткого вывода и схемы нечеткого вывода на основе НЗИ}
	\label{fig:ftv-schema-comparizon}
\end{figure}

Порядок функции временной сложности вычисления $B'_k$ на основе выражения (\ref{eqn:ftv-compute-11}) составляет $O\left(n|V|^2+|V|\cdot |Y|\right)$, где $V=[0;1]$. Сравнение схем нечетких выводов в соответствии с соотношениями (\ref{eqn:fuz-problem-4}) и (\ref{eqn:ftv-compute-11}) представлены на рис. \cref{fig:ftv-schema-comparizon}.

\ul{Вывод логического типа на основе нечеткого значения истинности}

Для использованной в работе дефаззификации по среднему максимуму вывод на основе нечеткого значения истинности выражается формулами:

\begin{align}
	\tau_{A_k|A'}(v) = \underset{i=\overline{1,n}}{\mathrm{\tilde{T}}} \left\{\mu_{CP(A_{ki}, A'_{t-p+i})}(v_i)\right\}, k=\overline{1,N},\\
	\hat{y}_{t+h} = \argmax_{y\in\mathbb{Y}} \left\{\Tnorm_{k=1}^N \left\{\sup_{v\in [0, 1]} \left\{\tau_{\mathbf{A_k}|\mathbf{A'}}(v)\overset{\mathrm{T}_2}{\star} I\left(v, \mu_{A_{k\,p+1}}(y)\right)\right\}\right\}\right\}.
\end{align}

Данным формулам соответствует сетевая структура нейро-нечеткой системы, изображенная на рисунке \cref{fig:nfs-ftv-and-defuz-meom-with-defuz-demo}.

\begin{figure}[thb]
	\centering
	\includegraphics[width=\linewidth]{nfs-ftv-and-defuz-meom-with-defuz-demo}
	\caption{Схема нейро-нечеткой системы с вычислением НЗИ и дефаззификацией по среднему максимуму, а также пример работы процедуры дефаззификации.}
	\label{fig:nfs-ftv-and-defuz-meom-with-defuz-demo}
\end{figure}

При использовании дискретной дефаззификации по центру тяжести в \cite{Karatach2024} показано, что для достаточно удаленных и непересекающихся выходных ф. п. нечетких множеств, т. е. когда $\mu_{B_k}(\bar{y}_r) = 0$ для $k \ne r$, сложность вычисления сокращается за счет упрощения выражений импликаций:
\begin{itemize}
\item для \textit{S}-импликации
\begin{equation*}
	\hat{y}_{CoG} = \frac{\sum_{k=1}^{N} \overline{y}_k \Tnorm_{r=1}^N \left\{\sup_{v\in [0, 1]} \left\{\tau_{A_r|A'}(v)\overset{\mathrm{T}_2}{\star}(1-v)\right\}\right\}}{\sum_{k=1}^{N} \Tnorm_{r=1}^N \left\{\sup_{v\in [0, 1]} \left\{\tau_{A_r|A'}(v)\overset{\mathrm{T}_2}{\star}(1-v)\right\}\right\}},
\end{equation*}
\item для \textit{R}-импликации
\begin{equation*}
	\hat{y}_{CoG} = \frac{\sum_{k=1}^{N} \overline{y}_k \Tnorm_{r=1}^N \left\{\tau_{A_r|A'}(0)\right\}}{\sum_{k=1}^{N} \Tnorm_{r=1}^N \left\{\tau_{A_r|A'}(0)\right\}},
\end{equation*}
\item для \textit{Q}-импликации
\begin{equation*}
	{\fontsize{11}{6}
		\hat{y}_{CoG} = \frac{
			% Numerator
			\begin{aligned}[t]
				\sum_{k=1}^{N} \overline{y}_k \mathrm{T}_2 \Bigg\{
				& \sup_{v\in [0, 1]} \left\{\tau_{A_k|A'}(v)\overset{\mathrm{T}_2}{\star}\max(1-v, v)\right\}\times \\
				& \times\Tnorm_{\substack{r=1\\r\ne k}}^N \left\{
				\sup_{v\in [0, 1]} \left\{\tau_{A_r|A'}(v)\overset{\mathrm{T}_2}{\star}(1-v)\right\}
				\right\}
				\Bigg\}
			\end{aligned}
		}{
			% Denominator (structure mirrors the numerator)
			\begin{aligned}[t]
				\sum_{k=1}^{N} \mathrm{T}_2 \Bigg\{
				& \sup_{v\in [0, 1]} \left\{\tau_{A_k|A'}(v)\overset{\mathrm{T}_2}{\star}\max(1-v, v)\right\}\times \\
				& \times\Tnorm_{\substack{r=1\\r\ne k}}^N \left\{
				\sup_{v\in [0, 1]} \left\{\tau_{A_r|A'}(v)\overset{\mathrm{T}_2}{\star}(1-v)\right\}
				\right\}
				\Bigg\}
			\end{aligned}
		}.
	}
\end{equation*}
\end{itemize}

\ul{Свойства вывода типа Мамдани на основе нечеткого значения истинности}

В \cite{Sinuk2023} ослаблено ограничение на использование одной и той же $T$-нормы в формуле композиционного правила вывода в работах Менделя для случая вывода типа Мамдани, а также показано, что вывод по отдельному правилу в случае $T_2 = T_4 = T$ может быть записан через \textit{меру возможности}:
\begin{align*}
	\mu_{B'_k}(y) = \sup_{v\in[0;1]}\left\{\tau_{A_{k}|A'}(v) \overset{\mathrm{T_2}}{\star} (v \overset{\mathrm{T_4}}{\star} \mu_{B_k}(y)) \right\} = \textstyle\prod_{\mathbf{A_k}|\mathbf{A'}} \overset{\mathrm{T}}{\star} \mu_{B_k}(y),
\end{align*}
где $\prod_{\mathbf{A_k}|\mathbf{A'}}=\sup_{v\in[0;1]}\left\{\tau_{A_{k}|A'}(v) \overset{\mathrm{T}}{\star} v\right\}$.

Если при этом используется дефаззификация \textit{по центру сумм (CoS)} и $T$-норма Ларсена, то, как доказано в \cite{Sinuk2023}, результат дефаззификации зависит от ширины гауссовой или треугольной функции принадлежности консеквента, тогда как дефаззификация \textit{по среднему центру} учитывает только параметр центра. Например, при использовании в качестве выходной ф. п. гауссовой функции $\mu_{B_k}(y) = exp(-((y-\bar{y}_k)/\sigma_k)^2)$ формула дефаззификации имеет вид: 

\begin{equation}
	\hat{y}_{CoS} = \frac{\int_{\mathbb{Y}} y \sum_{k=1}^{N} \prod_{\mathbf{A_k}|\mathbf{A'}} \overset{\mathrm{T}_2}{\star} \mu_{B_k}(y)}{\int_{\mathbb{Y}} \sum_{k=1}^{N} \prod_{\mathbf{A_k}|\mathbf{A'}} \overset{\mathrm{T}_2}{\star} \mu_{B_k}(y)} = \frac{\sum_{k=1}^{N} \prod_{\mathbf{A_k}|\mathbf{A'}} \bar{y}_k \sigma_k}{\sum_{k=1}^{N} \prod_{\mathbf{A_k}|\mathbf{A'}} \sigma_k},
\end{equation}
поскольку $	\int_{-\inf}^{\inf}\mu_{B_k}(y) dy = \sigma_k \sqrt{\pi}$ и $\int_{-\inf}^{\inf} y \mu_{B_k}(y) dy = \bar{y}_k \sigma_k \sqrt{\pi}$.


\textbf{Глава 3. <<Разработка алгоритмической реализации метода прогнозирования временных рядов на основе нечетких моделей>>}

Глава посвящена разработке эффективного алгоритма прогнозирования временных рядов нечеткой системой с использованием несинглтонной фаззификации посредством разработки параллельного алгоритма свертки НЗИ, алгоритма обучения базы правил нечеткой модели и алгоритма дефаззификации MeOM.


%Нейро-сетевая структура изображена на рисунке 

%\begin{figure}[ht]
%	\centering
%	\includegraphics[scale=0.5]{out-mf-with-low-crossing}
%	\caption{Пример нечетких множеств, удовлетворяющих условию $\mu_{B_k}(y_r) = 0$ для $y \ne r$.}
%	\label{fig:out-mf-with-low-crossing}
%\end{figure}



%\textbf{Третья глава} посвящена выработке эффективной параллельной реализации разработанного метода нечеткого вывода на основе нечеткого значения истинности с использованием технологии CUDA. В главе описан ключевые особенности организации вычисления нечеткого вывода при использовании технологии CUDA, параллельный алгоритм свертки НЗИ, особенности реализации методов дефаззификации в нечеткой модели регрессии и схема ускоренного вывода регрессионной нечеткой системы за счет предварительного отбора правил с ближайшими антецедентами.

\ul{3.1. Параллельный алгоритм свертки НЗИ}

При программной реализации вычисления НЗИ и свертки НЗИ $\tau_{A_{ki}|A'_i}$ вычисление производится в точках расчетной сетки. \ul{Значение НЗИ по $i$-му входу в точке расчетной сетки $v_j$ в данной работе обозначается $ftv_i[v_j]$ (\textit{ftv --- fuzzy truth value}).} Расчетная сетка размера $D_{ftv}$ задается на пространстве $\mathbb{V}=[0;1]$ мощности $|\mathbb{V}|$.

Для нахождения свертки НЗИ по одному правилу можно составить алгоритм на основе формулы (\ref{eqn:ftv-compute-10}). Вычислительная сложность при параллельной реализации такого алгоритма составит $O\left(D_{ftv}^2 \cdot \log{n}\right)$. Значения $ftv_i[v_j]$ необходимо вычислить до запуска алгоритма свертки, что потребует сложности по памяти $O\left(D_{ftv}\cdot n\right)$.

\begin{algorithm}
	\begin{algorithmic}
		\Require $ftv_i,\ i=\overline{1,n}$ --- это $\tau_{A_{ki}|A'_i}$ дискретизированная в точках $v_j$
		\State $max\_ftv[i] = 0;$
		\For{$v_j = 1\dots0$}
		\State $s \gets \left\{ftv_i[v_j] \mid ftv_i[v_j] >= max\_ftv[i]\right\};$
		\State $max\_ftv[i] \gets max(max\_ftv[i], ftv_i[v_j]);$
		\State $v\_max\_index \gets \mathrm{arg\,max}_i\left\{ftv_i[v_j]\right\};$
		\If{$s = \emptyset \And i = v\_max\_index$}
		\State $r[i] \gets ftv_{i}[v_j];$
		\Else
		\State $r[i] \gets max\_ftv[i];$
		\EndIf
		\State $ftv\_reduced[v_j] \gets \underset{i}{T_3}\left\{r[i]\right\}$;
		\EndFor
		\State \Return $ftv\_reduced$
	\end{algorithmic}
	\caption{Алгоритм свертки НЗИ при $T_1=min$}
	\label{alg:ftv-reduction}
\end{algorithm}

\begin{figure}[ht]
	\centering
	\includegraphics[width=\textwidth]{ftvs-reduction-example-gradient}
	\caption{Пример работы параллельного алгоритма свертки НЗИ при расчетной сетке состоящей из 5 точек.}
	\label{fig:ftvs-reduction-example}
\end{figure}

При выполнении работы был разработан параллельный алгоритм свертки НЗИ \cite{Karatach2023b} с вычислительной сложностью $O\left(D_{ftv}\cdot \log{n}\right)$. Алгоритм \ref{alg:ftv-reduction} разработан при допущении, что $T_1 = min$, тогда $\underset{i=\overline{1,n}}{\mathrm{T_1}}v_i = \min_{i=\overline{1,n}} v_i$ в формуле (\ref{eqn:ftv-compute-8}). При работе алгоритм итеративно продвигается от 1 к 0 в области $\mathbb{V}$, как показано на рисунке \cref{fig:ftvs-reduction-example}. На каждой $j$-й итерации вычисляются значения $ftv_i[v_j]$, которые агрегируются в одном вспомогательном массиве \textit{max\_ftv}, который требует сложности по памяти $O\left(n\right)$.

%При дискретизированном вычисление ф. п. свертки НЗИ в некоторой точке расчетной сетки $v_j\in [0,1]$ потребуется просматривать значения НЗИ в отрезке $[v_j, 1]$, то есть имеет вычислительную сложность $O(D_{ftv})$, где $D_{ftv}$ --- число точек расчетной сетки ф. п. НЗИ. Таким образом вычисление свертки НЗИ по формуле (\ref{eqn:ftv-compute-11}) может быть распараллелено по точкам расчетной сетки, а нахождение $\tau_{\mathbf{A_k}|\mathbf{A'}}(v_j)$ использует операцию свертки, которая в имеет ограниченную возможность распараллеливания, но в целом требует большого количества повторных вычислений значений $\tau_{A_{ki}|A'_i}(v_k), v_k\in [v_j, 1]$. В \ref{alg:ftv-reduction} \cite{} предложен алгоритм вычисления свертки НЗИ сразу по всем входам с использованием техники динамического программирования, имеющий линейную зависимость от размера расчетной сетки $D_{ftv}$..


\ul{3.2. Адаптация алгоритма PSO для построения базы правил.}

Для построения базы правил $\mathbf{R}$ на основе набора данных сперва данные были представлены в виде входных нечетких множеств посредством фаззификации. Затем выполнялась оптимизация матрицы параметров ф. п. нечетких множеств базы правил $\theta_{\mathbf{R}}$:

\begin{equation*}
	\theta_{\mathbf{R}} = \begin{bmatrix}
		\theta_{\mu_{\mathbf{R_1}}}\\
		\vdots\\
		\theta_{\mu_{\mathbf{R_N}}}
	\end{bmatrix} = \begin{bmatrix}
		\theta_{\mu_{A_{11}}} & \theta_{\mu_{A_{12}}} & \dots & \theta_{\mu_{A_{1n}}} & \theta_{\mu_{B_{1}}} \\
		\vdots & \vdots & \ddots & \vdots & \vdots \\
		\theta_{\mu_{A_{N1}}} & \theta_{\mu_{A_{N2}}} & \dots & \theta_{\mu_{A_{Nn}}} & \theta_{\mu_{B_{N}}} \\
	\end{bmatrix}.
\end{equation*}

В качестве функций принадлежностей в работе используются гауссовы функции, которые задаются набором параметров:
\begin{equation*}
	\theta_{\mu_{A_{ki}}} = \langle a_{\mu_{A_{ki}}}, b_{\mu_{A_{ki}}}\rangle,\quad\theta_{\mu_{B_{k}}} = \langle a_{\mu_{B_{k}}}, b_{\mu_{B_{k}}}\rangle,
\end{equation*}

где $a$ и $b$ --- математическое ожидание и среднеквадратичное отклонение гауссовой функции принадлежности.
 
Подбор параметров для фиксированного количества правил и заданной метрики осуществлялся с использованием адаптированного алгоритма оптимизации метод роя частиц (Particle Swarm Optimization, PSO), который приведен в алгоритме \ref{alg:pso}.
 
 \begin{algorithm}[p]
 	\caption{Particle Swarm Optimization (PSO) для подбора параметров ф. п. в правилах на основе эталонных данных}
 	\label{alg:pso}
 	\begin{algorithmic}[1]
 		\Require
 		\Statex $S$ --- количество частиц
 		\Statex $max\_iter$ --- количество итераций
 		\Statex $\omega$ --- вес инерции
 		\Statex $\phi_l, \phi_g$ --- коэффициенты влияния локального и глобального оптимума
 		\Statex $b_{lo}, b_{up}$ --- вектора нижних и верхних граничных значений вектора параметров частицы $\theta_p$
 		\Statex $D_{l=1}^M$ --- набор эталонных данных
 		\Statex $f(\theta)$ --- целевая функция приспособленности для набора данных $D$
 		
 		\Statex \textbf{Инициализация:}
 		\For{каждой частицы $p = 1, \dots, S$}
 		\State Инициализировать позицию частицы по равномерному распределению: $\theta_p \sim U(b_{lo}, b_{up})$
 		\State Установить $\theta^l_p \gets \theta_p$ \Comment{Локальный оптимум частицы}
 		\State Инициализировать скорость по равномерному распределению: $v_p \sim U(-|b_{up}-b_{lo}|, |b_{up}-b_{lo}|)$ \Comment{Вектор скорости $v_p$ имеет такую же размерность как и вектор параметров $\theta_p$}
 		\EndFor		
 		\State $\theta^g \gets \argmin_{p} f(\theta^l_p)$ \Comment{Инициализация глобального оптимума}
 		
 		\Statex \textbf{Основной цикл:}
 		\For{$i = 1, \dots, max\_iter$}
 		\For{каждой частицы $p = 1, \dots, S$}
 		\State Сгенерировать случайные $r_l, r_g \sim U(0,1)$
 		\State Обновить скорость:
 		\State \quad $v_p \gets \omega v_p + \phi_l r_l (\theta^l_p - \theta_p) + \phi_g r_g (\theta^g - \theta_p)$
 		\State Обновить позицию:  $\theta_p \gets \theta_p + v_p$
 		\If{$f(\theta_p) < f(\theta^l_p)$}
 		\State Обновить локальный оптимум: $\theta^l_p \gets \theta_p$
 		\If{$f(\theta^l_p) < f(\theta^g)$}
 		\State Обновить глобальный оптимум: $\theta^g \gets \theta^l_p$
 		\EndIf
 		\EndIf
 		\EndFor
 		\EndFor
 		
 		\State \textbf{Возврат} $\theta^g$ \Comment{Найденный глобальный оптимум}
 	\end{algorithmic}
 \end{algorithm}

Минимально необходимый объем данных в наборе для обучения обычно оценивается формулой:
\[
C \times N \times n \times <\textit{количество параметров ф. п.}>,
\]
где $C$ --- коэффициент, зависящий от однородности распределения измеренных значений временного ряда и сложности закономерностей в исходных временных рядах.
 
\ul{3.3. Применение алгоритма оптимизации на основе метода роя частиц для вычисления дефаззификации по среднему максимуму}
 
Процедура дефаззификации по методу среднего максимума в большинстве случаев сводится к нахождению единственного значения $\hat{y}$, при котором $\mu_{B'}(y)$ принимает максимальное значение. При выводе логического типа возможно возникновение конфигурации функций принадлежности $\mu_{B'_k}$ на рис. \ref{fig:meom-use-case}, образующих <<плато>> на области пересечения. Тогда значение $\hat{y}$ вычисляется как среднее из координат $y$, где $\mu_{B'_k}$ принимает максимальное значение. В работе такой набор координат определяется с использованием алгоритма оптимизации \textit{Gradient-aware Particle Swarm Optimization}, где шаг обновления вектора скорости и координаты частицы задается формулой:
\begin{align*}
 	\begin{split}
 		v_i^{(k+1)} &= \omega v_i^{(k)} +\\
 		&+ \alpha_l \left(
 		r_l\left(
 		y_i^{best} - y_i^{(k)}
 		\right) + (1-r_l)\left(
 		-\frac{\mu_{B'}^{'}(y_i^{(k)})}{\mu_{B'}^{''}(y_i^{(k)})}
 		\right)
 		\right) + \\
 		&+ \alpha_g \left(
 		r_g \mu_{B'}(y^{best})\left(
 		y^{best}-y
 		\right) + (1-r_g) \left(
 		1-\mu_{B'}(y^{best})
 		\right) \left(
 		\hat{y}_{CA} - y^{(k)}
 		\right)
 		\right), \label{eqn:defuz-impl-meom-4-1}
 	\end{split}\\
 	y^{(k+1)} &= y^{(k)} + v^{(k+1)}, \nonumber
 \end{align*}
 где $v_i^{(k)}$ --- вектор скорости $i$-й точки на $k$-й итерации, $\alpha_l$ и $\alpha_g$ --- коэффициенты вклада локального и глобального оптимума в корректировку вектора скорости, $\mu_{B'}^{'}(y_i^{(k)})$ и $\mu_{B'}^{''}(y_i^{(k)})$ --- первая и вторая производная выходной гауссовой функции принадлежности в текущей точке $y_i^{(k)}$, $y^{best}$ --- текущая точка глобального оптимума.
 
 В процессе работы этого алгоритма выделяется набор координат с максимальным значением оптимизируемой функции, как показано на рис. \ref{fig:defuz-meom-pos-hue}.
 
\begin{figure}[htbp]
	\centering
	\begin{minipage}[c]{0.35\textwidth}
		\centering
		\includegraphics[width=\textwidth]{meom-use-case}
		\caption{Иллюстрация возникновения <<плато>> при дефаззификации свертки правил $\mu_{B'}(y)$ (закрашенная область).}
		\label{fig:meom-use-case}
	\end{minipage}
	\hfill
	\begin{minipage}[c]{0.6\textwidth}
		\centering
		\includegraphics[width=\textwidth]{defuz-meom-pos-hue}
		\caption{Реализация алгоритма дефаззификации на основе PSO для усреднения по точкам роя, попадающих в плато максимумов.}
		\label{fig:defuz-meom-pos-hue}
	\end{minipage}
\end{figure}


\textbf{Глава 4. <<Разработка информационной технологии прогнозирования временных рядов, прототипа ее программной реализации на основе нечеткой модели и оценка работоспособности>>}

Глава содержит описание нескольких проведенных экспериментов для оценки характеристик разработанной нечеткой модели прогнозирования временных рядов. Первый эксперимент направлен на подтверждение полиномиальной зависимости времени нечеткого вывода от количества входов нечеткой системы, а также на прирост качества прогнозирования при использовании нечеткого вывода логического типа с несинглтонной фаззификацией. Второй эксперимент был проведен для оценки качества в прикладной задаче прогнозирования временных рядов.


\ul{4.1. Библиотека с параллельной реализацией нечеткого вывода на основе технологии CUDA}

Для более оперативного проведения экспериментов и практического применения в нагруженных промышленных приложениях была выполнена параллельная реализация нечеткого вывода на основе НЗИ с использованием языка программирования С++ и технологии CUDA. Для удобства использования к разработанному модулю вывода был реализован интерфейс из языка Python с помощью расширения Cython. Схема использования изображена на рисунке \cref{fig:application-schema-diagram}.

Важным достоинством реализации является полная организация вычислений внутри \textit{потоковых мультипроцессоров} графических ускорителей за счет размещения всей базы правил и пакета экземпляров входных данных в разделяемой памяти на чипе потокового мультипроцессора, что предотвращает возникновение простоя арифметико-логических модулей при ожидании загрузки порции данных (например, базы правил) из глобальной памяти графического ускорителя. Также, вычисления организованы внутри группы из 32 CUDA-нитей, что избавляет от необходимости синхронизации внутри CUDA-блока и позволяет использовать инструкции аппаратной свертки массивов чисел внутри таких групп.

В библиотеке реализована дискретизированная дефаззификация по центру тяжести и дефаззификация по среднему максимуму.

\begin{figure}[ht]
	\centering
	\includegraphics[width=\linewidth]{application-schema-diagram}
	\caption{Схема использования библиотеки для нечеткого моделирования и прогнозирования временных рядов.}
	\label{fig:application-schema-diagram}
\end{figure}


\ul{4.2. Оценка работоспособности разработанного метода прогнозирования на основе нечеткого логического вывода относительно других типов нечетких моделей и с позиции вычислительной сложности}

Первый эксперимент проводился с использованием синтетического набора данных Mackey-Glass (M-G). В данной работе этот набор данных был сгенерирован в результате решения дифференциального уравнения:
\begin{equation}
	\frac{dx(t)}{dt} = \beta\frac{x(t-\tau)}{1+x(t-\tau)^n}-\gamma x(t)
	\label{eqn:mackey-glass-definition},
\end{equation}
со значениями параметров $\tau = 30, \beta = 0.2, \gamma = 0.1$.

В эксперименте использовался участок временного ряда $t=\overline{1,1000}$, а также применялся адаптивный метод оценки зашумленности временной последовательности в каждой точке $t$ на основе экспоненциально взвешенного скользящего среднего.

Нечеткие множества для значений временного ряда были получены с использованием этой процедуры фаззификации временных рядов (\cref{fig:ns-procedure}) для обеспечения адаптивности оценки неопределенности в конкретной точке. Формулы для вычисления степени неопределенности показаны ниже%

\begin{minipage}{0.45\linewidth}
\begin{align}
	\label{eqn:mackey-glass-seq-diff}
	d_1 &= d_2, \notag \\
	d_t &= \frac{1}{\sqrt{2}}(x_t - x_{t-1}),
\end{align}
\begin{align}
	\hat{d}_t &= (1-\alpha) \hat{d}_{t-1} + \alpha d_t \notag \\
	&= \sum_{p=1}^t \alpha (1-\alpha)^{t-p} d_p. %\notag
	\label{eqn:mackey-glass-seq-diff-mean}
\end{align}
\end{minipage}\hfill
\begin{minipage}{0.45\linewidth}
\begin{align}
	\hat{\sigma}^2_t &= (1-\alpha) \hat{\sigma}^2_{t-1} + \alpha (d_t - \hat{d}_t) \notag \\
	&= \sum_{p=1}^t \alpha (1-\alpha)^{t-p} (d_p - \hat{d}_p)^2, \label{eqn:mackey-glass-seq-diff-var-iterative} \\
	\hat{\sigma}_t &= \sqrt{\hat{\sigma}^2_t}, \label{eqn:mackey-glass-seq-diff-std}
\end{align}
\end{minipage}

\begin{figure}[ht]
	\centering
	\includegraphics[scale=0.3]{mackey-glass-ewma-example}
	\caption{График сгенерированной последовательности Mackey-Glass $x(t), t\in[0;999]$, график разностей соседних точек $d_t$ последовательности $x(t)$, график $\hat{d}_t$ с наложением экспоненциально взвешенного сглаживания на последовательность разностей и график экспоненциально взвешенного скользящего среднеквадратичного отклонения разностей $\hat{\sigma}_t$. На вложенном изображении участка $t\in[650,750]$ яркостью красного цвета показано значения весового коэффициента $\alpha (1-\alpha)^{t-p}, p=\overline{1,t_0}$ при $\alpha = 0.2$.}
	\label{fig:mackey-glass-ewma-example}
\end{figure}

\begin{figure}[tbh]
	\centering
	\includegraphics[scale=0.7]{mackey-glass-inference-duration}
	\caption{График длительности выполнения параллельной реализации нечеткого вывода для обучающего и тестового набора данных при количестве правил $N=30$.}
	\label{fig:mackey-glass-inference-duration}
\end{figure}

После проведенного вычислительного эксперимента были получены показатели удельного (на одну точку из набора точек одной итерации алгоритма PSO) времени работы параллельного алгоритма нечеткого вывода на основе НЗИ на обучающем наборе данных и времени работы на тренировочном наборе данных для различного размера окна запаздывания, изображенные на рисунке \cref{fig:mackey-glass-inference-duration}. На этом рисунке наблюдается линейный рост времени выполнения алгоритма с увеличением количества входов нечеткой системы, что \textbf{подтверждает утверждение о полиномиальной зависимости временной сложности метода нечеткого вывода на основе НЗИ от количества входов}.

Качество прогнозирования оценивалось с использованием метрики sMAPE:
\[
sMAPE = \frac{100\%}{n} \sum_{t=1}^n 
\frac{|y_t - \hat{y}_t|}{\tfrac{|y_t| + |\hat{y}_t|}{2}},
\]
где $y_t$ и $\hat{y}_t$ соответствуют истинному и предсказанному значению в момент времени $t$.

\begin{figure}
	\centering
	\includegraphics[scale=0.7]{mackey-glass-inference-smape}
	\caption{График значений метрики sMAPE на обучающем и тестовом наборах данных при различных размерах окна запаздывания, количестве правил --- 30.}
	\label{fig:mackey-glass-inference-smape}
\end{figure}

По итогу проведенного эксперимента лучший показатель качества прогнозирования по этой метрике на рисунке \cref{fig:mackey-glass-inference-smape} достигается при размере окна запаздывания --- 3 точки.

%
Достигнутое в этом случае значение $sMAPE = 8\%$ при количестве правил 30, заметно превосходит точность моделирования незашумленной последовательности Mackey-Glass (M-G) с использованием синглтонной фаззификации со значением $sMAPE \approx 40\%$. Также полученное качество прогнозирования сопоставимо со значением этой метрики при аналогичной конфигурации эксперимента прогнозирования временного ряда M-G, где для достижения точности моделирования временной последовательности $sMAPE \approx 10\%$ используется нечеткая система типа Мамдани, содержащая 184 правила в базе правил для не зашумленного временного ряда M-G и 597, 402, 312 правил для различных конфигураций и амплитуды добавленного шума. Данные наблюдения показывают, что \textbf{метод прогнозирования временных рядов на основе логического нечеткого вывода при несинглтонной фаззификации значительно превосходит качество прогнозирования с использованием синглтонной фаззификации, а также имеет сопоставимую с методом прогнозирования при выводе Мамдани с несинглтонной фаззификацией точность, но при меньшем количестве правил} за счет возможности построения более сложной функции аппроксимации.


\ul{4.3. Оценка работоспособности разработанной информационной технологии прогнозирования на основе нечеткой модели относительно вероятностных подходов.}

%\todo{Как показала проведенная кластеризация временных рядов помесячных объемов транзакций безналичных платежей, можно выделить набор уникальных групп корпоративных клиентов банка с общим транзакционным профилем. выделились уникальные группы клиентов, объединенные характером бизнеса и внешними экономическими условиями.} 

\begin{figure}[ht]
	\centering
	\includegraphics[width=0.65\linewidth]{acquiring-system-flowchart}
	\caption{Схема использования прогнозов объема транзакций по безналичным платежам в банковской системе.}
	\label{fig:acquiring-system-flowchart}
\end{figure}
Второй эксперимент посвящен применению разработанного метода для прогнозирования помесячного объема транзакций безналичных платежей корпоративных клиентов банка. Результаты прогнозирования интегрируются в прогнозы других моделей и используются в системе управления выдачей кредитов юридическим лицам. Транзакционная активность юридических лиц является уникальным процессом из-за нишевой бизнес-модели и уникальных экономических условий. Источником неопределенности в этом наборе данных является стохастический характер динамики временной последовательности, из-за чего каждый временной ряд является нестационарным. Поэтому в данном эксперименте также использовалась процедура адаптивной несинглтонной фаззификации. В качестве метрики выбрана RMAE (relative MAE) --- отношение средней абсолютной ошибки к математическому ожиданию средних по временным рядам клиентов:
\[
RMAE = \frac{MAE}{\mathbb{E}[\mathbb{E}[s_t]]}.
\]

В таблице \ref{tab:acquiring-metric-comparison} приведены значения метрики качества при прогнозировании на 1 и 3 месяца для моделей: наивная, Бокса-Дженкинса, градиентный бустинг, многослойный перцептрон, DeepAR. 

\begin{table}[t]
	\centering
	\begin{threeparttable}% выравнивание подписи по границам таблицы
		\caption{Значения метрики MAE относительно $\mathbb{E}[\mathbb{E}[s_t]]$ для разработанной нечеткой и альтернативных моделей.}%
		\label{tab:acquiring-metric-comparison}%
		\begin{tabular}{| c | c | c |}
			\toprule
			\multirow{2}{*}{Модель} & \multicolumn{2}{|c|}{Relative Mean Absolute Error (RMAE)} \\
			\cmidrule{2-3} & Прогноз на 1 мес. & Средняя за 3 мес. \\
			\midrule
			Наивная (среднее по ряду) & 0.166 & 0.204 \\
			Модель Бокса-Дженкинса & 0.187 & 0.230  \\
			Градиентный бустинг & 0.152  & 0.187 \\
			Многослойный перцептрон & 0.128 & 0.157  \\
			Рекуррентная нейросеть (DeepAR) & 0.188	 & 0.231 \\
			\midrule
			Разработанная нечеткая модель & 0.109  & 0.142  \\ % +20000
			\bottomrule
		\end{tabular}%
	\end{threeparttable}
\end{table}

Стоит описать некоторые детали применения и используемую конфигурацию других моделей:
\begin{itemize}
\item В наивной модели прогноз формируется как среднее значение в окне запаздывания.
\item При использовании модели Бокса-Дженкинса для каждого клиента обучалась отдельная авторегрессионная модель.
\item В качестве градиентного бустинга использовался CatBoostRegressor. На вход модели подавались признаки для различных размеров окон запаздывания: 3, 6, 9 и 12. Для каждого прогнозного месяца была построена отдельная модель бустинга.
\item Многослойный перцептрон имел размерность скрытых слоев --- 1024 и количество полносвязных слоев --- 4.
\item В рекуррентной модели DeepAR использовалась размерность скрытого состояния LSTM-слоя --- 128 и количество слоев LSTM --- 4.
\end{itemize}

По итогу эксперимента было получено значение метрики $RMAE = 0.109/0.142$ при прогнозировании на один/три месяца соответственно. Это превосходит на $17\%/11\%$ качество прогнозирования с использованием многослойного перцептрона со значениями $RMAE = 0.128/0.157$.




%В заключении перечислены основные научные результаты, каждый из которых подтверждён приведёнными формулами, схемами, экспериментальными графиками и таблицами: (1) формализация и аналитическая реализация метода на основе НЗИ; (2) снижение вычислительной сложности и эффективная параллельная реализация; (3) экспериментальная оценка на реальных задачах; (4) создание программной системы с поддержкой GPU и интеграцией в Python.

В \textbf{заключении} сделаны выводы о полученных в процессе работы результатах.

\pdfbookmark{Основные результаты и выводы}{conclusion}                                  % Закладка pdf
\section*{Основные результаты и выводы}
\input{common/concl}

\pdfbookmark{Литература}{bibliography}                                % Закладка pdf
%При использовании пакета \verb!biblatex! список публикаций автора по теме
%диссертации формируется в разделе <<\publications>>\ файла
%\verb!common/characteristic.tex!  при помощи команды \verb!\nocite!

\ifdefmacro{\microtypesetup}{\microtypesetup{protrusion=false}}{} % не рекомендуется применять пакет микротипографики к автоматически генерируемому списку литературы
\urlstyle{rm}                               % ссылки URL обычным шрифтом
\ifnumequal{\value{bibliosel}}{0}{% Встроенная реализация с загрузкой файла через движок bibtex8
	\renewcommand{\bibname}{\large \bibtitleauthor}
	\nocite{*}
	\insertbiblioauthor           % Подключаем Bib-базы
	%\insertbiblioexternal   % !!! bibtex не умеет работать с несколькими библиографиями !!!
}{% Реализация пакетом biblatex через движок biber
	% Цитирования.
	%  * Порядок перечисления определяет порядок в библиографии (только внутри подраздела, если `\insertbiblioauthorgrouped`).
	%  * Если не соблюдать порядок "как для \printbibliography", нумерация в `\insertbiblioauthor` будет кривой.
	%  * Если цитировать каждый источник отдельной командой --- найти некоторые ошибки будет проще.
	%
	
	
	\ifnumgreater{\value{usefootcite}}{0}{
		\begin{refcontext}[labelprefix={}]
			\ifnum \value{bibgrouped}>0
			\insertbiblioauthorgrouped    % Вывод всех работ автора, сгруппированных по источникам
			\else
			\insertbiblioauthor      % Вывод всех работ автора
			\fi
		\end{refcontext}
	}{
		\ifnum \totvalue{citeexternal}>0
		\begin{refcontext}[labelprefix=A]
			\ifnum \value{bibgrouped}>0
			\insertbiblioauthorgrouped    % Вывод всех работ автора, сгруппированных по источникам
			\else
			\insertbiblioauthor      % Вывод всех работ автора
			\fi
		\end{refcontext}
		\else
		\ifnum \value{bibgrouped}>0
		\insertbiblioauthorgrouped    % Вывод всех работ автора, сгруппированных по источникам
		\else
		\insertbiblioauthor      % Вывод всех работ автора
		\fi
		\fi
		%  \insertbiblioauthorimportant  % Вывод наиболее значимых работ автора (определяется в файле characteristic во второй section)
		\begin{refcontext}[labelprefix={}]
			\insertbiblioexternal            % Вывод списка литературы, на которую ссылались в тексте автореферата
		\end{refcontext}
		% Невидимый библиографический список для подсчёта количества внешних публикаций
		% Используется, чтобы убрать приставку "А" у работ автора, если в автореферате нет
		% цитирований внешних источников.
		\printbibliography[heading=nobibheading, section=0, env=countexternal, keyword=biblioexternal, resetnumbers=true]%
	}
	\clearpage
}
\ifdefmacro{\microtypesetup}{\microtypesetup{protrusion=true}}{}
\urlstyle{tt}                               % возвращаем установки шрифта ссылок URL
